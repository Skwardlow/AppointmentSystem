<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Запись</title>

    <script src="http://code.jquery.com/jquery-3.4.1.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/css/bootstrap-datepicker.min.css" rel="stylesheet"/>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/js/bootstrap-datepicker.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <link href="css/client.css" rel="stylesheet">
    <script src="js/client.js" type="text/javascript"></script>
</head>

<script>

    $(document).ready(function(){
        $('#datepicker').datepicker({
            weekStart: 1,
            daysOfWeekHighlighted: "6,0",
            autoclose: true,
            todayHighlight: true,
        });
        $('#datepicker').datepicker("setDate", new Date());

        $.get("/users_get",
            function(data){
                var selectList = document.getElementById("specList");
                for(var i = 0; i < data.length; i++) {
                    var option = document.createElement("option");
                    option.value = data[i].username ;
                    option.text = data[i].name;
                    selectList.appendChild(option);
                }
            }
        );
        $('#specList');

    });

    function Change(event) {
        if($('#specList').val() != null){
            $("#outputDate").html("");
            var specDay = {};
            specDay.spec = $('#specList').val();
            specDay.date = $('#datepicker').val();
            $.ajax({
                type: "POST",
                url: '/get_dayspec',
                dataType : "json",
                data: specDay
            }).done(function( msg ) {
                alert(msg[0].id);
                var beginDay = msg[0].beginWorkDayHour;
                for(var i = 0; i < msg.length; i++) {
                    $("#outputDate")
                        .append('<div class="input-group">\n' +
                            '                    <div class="input-group-prepend">\n' +
                            '                        <div class="input-group-text">\n' +
                            '                            <input type="checkbox" id = "' + "indexOfDay" + i + '" value="'+msg[i].id+'"  aria-label="Checkbox for following text input">\n' +
                            '                        </div>\n' +
                            '                    </div>\n' +
                            '                    <input disabled type="text" class="form-control"  aria-label="Text input with checkbox" value="'+msg[i].dateOfAppointment + " - " + (beginDay+msg[i].indexInDay) + ":00" + " - " + msg[i].cusername +'">\n' +
                            '                </div>')


                }
            });

        }

    }

</script>

<body class="body">
<nav class="navbar navbar-light" style=" background-color: #a9ce71;">
    <span class="navbar-brand mb-0 h1">Запись</span>
</nav>

<div class="container" >
    <div class="row">
        <div class="col-5 " style="background-color: #c8e195;">
            <br>
            <div class="form-group">
                <label class = "font-menu " for="specList" >Выберите специалиста</label>
                <div class="row">
                    <div class="col">
                        <select onchange="Change(event)" class="form-control input-style" id="specList" style="width: 207px; height: 38px">

                        </select>
                    </div>
                </div>
                <label class = "font-menu" for="datepicker" >Выберите дату</label>
                <div class="row" style="padding-bottom: 25px">
                    <div class="col">
                        <input onchange="Change(event)" class="data-style" data-date-format="dd/mm/yyyy" id="datepicker" >
                    </div>
                </div>
                <br><br><br><br><br>
                <br><br><br><br><br>
                <br><br>
                <div class="row">
                    <div class="col">
                        <button type="button" class="btn btn-secondary button-style" id="writeOn">Записаться</button>
                    </div>
                    <div class="col">
                    </div>
                </div>
            </div>
        </div>

        <div class="col-7 " style="background-color: #d4d4d4;">
        </div>
    </div>
</div>

<script type="text/javascript">

</script>

</body>

</html>